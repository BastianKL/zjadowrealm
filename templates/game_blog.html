{% extends "base.html" %}

{% block title %}Game Development Blog{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card shadow-lg">
                <div class="card-header bg-gradient-dark text-white">
                    <h2 class="mb-0">
                        <i class="fas fa-gamepad me-2"></i>Game Development Documentation
                    </h2>
                </div>
                <div class="card-body p-0">
                    <!-- Navigation Tabs -->
                    <ul class="nav nav-tabs nav-fill" id="gameBlogTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="news-tab" data-bs-toggle="tab" data-bs-target="#news" type="button" role="tab">
                                <i class="fas fa-newspaper me-2"></i>News
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="story-tab" data-bs-toggle="tab" data-bs-target="#story" type="button" role="tab">
                                <i class="fas fa-book me-2"></i>Story
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="world-tab" data-bs-toggle="tab" data-bs-target="#world" type="button" role="tab">
                                <i class="fas fa-globe me-2"></i>World
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="mechanics-tab" data-bs-toggle="tab" data-bs-target="#mechanics" type="button" role="tab">
                                <i class="fas fa-cogs me-2"></i>Mechanics
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="wiki-tab" data-bs-toggle="tab" data-bs-target="#wiki" type="button" role="tab">
                                <i class="fas fa-book-open me-2"></i>Wiki
                            </button>
                        </li>
                    </ul>

                    <!-- Tab Content -->
                    <div class="tab-content" id="gameBlogTabContent">
                        <!-- News Tab -->
                        <div class="tab-pane fade show active" id="news" role="tabpanel">
                            <div class="p-4">
                                <h3 class="text-primary mb-4">
                                    <i class="fas fa-newspaper me-2"></i>Latest News & Updates
                                </h3>
                                
                                <div class="row">
                                    <div class="col-md-8">
                                        <!-- News Posts -->
                                        <div class="card mb-4">
                                            <div class="card-header bg-primary text-white">
                                                <h5 class="mb-0">Combat System Overhaul - v2.1.0</h5>
                                                <small class="text-light">Posted on November 18, 2025</small>
                                            </div>
                                            <div class="card-body">
                                                <p>Major update to the combat mechanics! New dash abilities, spell combinations, and enemy AI improvements.</p>
                                                <ul class="list-unstyled">
                                                    <li><i class="fas fa-plus text-success me-2"></i>Added 15 new spell combinations</li>
                                                    <li><i class="fas fa-plus text-success me-2"></i>Improved boss AI patterns</li>
                                                    <li><i class="fas fa-wrench text-warning me-2"></i>Fixed portal teleportation bugs</li>
                                                    <li><i class="fas fa-balance-scale text-info me-2"></i>Rebalanced weapon damage scaling</li>
                                                </ul>
                                            </div>
                                        </div>

                                        <div class="card mb-4">
                                            <div class="card-header bg-success text-white">
                                                <h5 class="mb-0">New Realm: The Crystalline Depths</h5>
                                                <small class="text-light">Posted on November 15, 2025</small>
                                            </div>
                                            <div class="card-body">
                                                <p>Explore the newly added Crystalline Depths realm in the Elemental Corral! Features unique crystal-based enemies and mining mechanics.</p>
                                                <ul>
                                                    <li>Crystal Harvesting mechanics</li>
                                                    <li>8 new enemy types</li>
                                                    <li>The Crystal Golem boss</li>
                                                    <li>Gem-crafting system</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-4">
                                        <!-- Sidebar -->
                                        <div class="card">
                                            <div class="card-header bg-dark text-white">
                                                <h6 class="mb-0">Quick Stats</h6>
                                            </div>
                                            <div class="card-body">
                                                <p class="mb-2"><strong>Current Version:</strong> v2.1.0</p>
                                                <p class="mb-2"><strong>Total Corrals:</strong> 5</p>
                                                <p class="mb-2"><strong>Total Realms:</strong> 23</p>
                                                <p class="mb-2"><strong>Unique Enemies:</strong> 127</p>
                                                <p class="mb-2"><strong>Boss Fights:</strong> 15</p>
                                                <p class="mb-0"><strong>Last Update:</strong> Nov 18, 2025</p>
                                            </div>
                                        </div>
                                        
                                        <div class="card mt-3">
                                            <div class="card-header bg-warning text-dark">
                                                <h6 class="mb-0">Coming Soon</h6>
                                            </div>
                                            <div class="card-body">
                                                <ul class="list-unstyled">
                                                    <li><i class="fas fa-clock text-warning me-2"></i>Multiplayer Co-op</li>
                                                    <li><i class="fas fa-clock text-warning me-2"></i>Guild System</li>
                                                    <li><i class="fas fa-clock text-warning me-2"></i>PvP Arenas</li>
                                                    <li><i class="fas fa-clock text-warning me-2"></i>Housing System</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Story Tab -->
                        <div class="tab-pane fade" id="story" role="tabpanel">
                            <div class="p-4">
                                <h3 class="text-warning mb-4">
                                    <i class="fas fa-book me-2"></i>Main Story Campaign
                                </h3>
                                
                                <div class="accordion" id="storyAccordion">
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#chapter1Content">
                                                <i class="fas fa-scroll me-2"></i>Chapter 1: The Awakening
                                            </button>
                                        </h2>
                                        <div id="chapter1Content" class="accordion-collapse collapse show" data-bs-parent="#storyAccordion">
                                            <div class="accordion-body">
                                                <h5 class="text-primary">The Journey Begins</h5>
                                                <p class="lead">You awaken in the Mortal Realm with no memory of your past, only a strange mark glowing on your hand...</p>
                                                <p>The world around you pulses with an energy you don't understand. Ancient corrals stretch across the horizon, each containing realms of unimaginable power and danger.</p>
                                                <blockquote class="blockquote border-start border-primary border-4 ps-3">
                                                    <p class="fst-italic">"The mark chooses its bearer, but the bearer must choose their destiny." - Elder Zephyr</p>
                                                </blockquote>
                                                <hr>
                                                <h6 class="text-success">Objectives:</h6>
                                                <ul>
                                                    <li>Explore the Tutorial Plains</li>
                                                    <li>Defeat the Shadow Wolf</li>
                                                    <li>Unlock your first Corral</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#chapter2Content">
                                                <i class="fas fa-scroll me-2"></i>Chapter 2: Corral Mysteries
                                            </button>
                                        </h2>
                                        <div id="chapter2Content" class="accordion-collapse collapse" data-bs-parent="#storyAccordion">
                                            <div class="accordion-body">
                                                <h5 class="text-danger">The Truth Unveiled</h5>
                                                <p class="lead">As you delve deeper into the first Corral, ancient secrets begin to surface...</p>
                                                <p>The realms within each Corral are not natural formations - they are prisons, containing entities of immense power.</p>
                                                <hr>
                                                <h6 class="text-success">Objectives:</h6>
                                                <ul>
                                                    <li>Investigate the Crystal Sanctum</li>
                                                    <li>Confront the Guardian of Whispers</li>
                                                    <li>Discover the truth about the Corrals</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Characters Stories and Lore -->
                                <div class="mt-5">
                                    <h3 class="text-info mb-4">
                                        <i class="fas fa-users me-2"></i>Characters Stories and Lore
                                    </h3>
                                    
                                    <div class="row">
                                        <!-- Key Characters -->
                                        <div class="col-lg-6 mb-4">
                                            <div class="card">
                                                <div class="card-header bg-primary text-white">
                                                    <h5 class="mb-0"><i class="fas fa-crown me-2"></i>Key Characters</h5>
                                                document.getElementById('areaTitleText').textContent = selectedArea;
                                                document.getElementById('areaDetails').classList.remove('d-none');

                                                const data = areaContentData[selectedArea] || {
                                                    lore: "Details coming soon.",
                                                    materials: [],
                                                    mobs: { races: [], enemies: [], animals: [], bosses: [] },
                                                    structures: [],
                                                    characters: []
                                                };

                                                // Lore
                                                document.getElementById('areaLore').textContent = data.lore || '';

                                                // Materials
                                                const materialsList = document.getElementById('materialsList');
                                                materialsList.innerHTML = '';
                                                if (data.materials?.length) {
                                                    data.materials.forEach(m => {
                                                        const div = document.createElement('div');
                                                        div.className = 'mb-2';
                                                        div.innerHTML = `<strong>${m.name}</strong><br><span class="text-muted small">${m.lore}</span><br><em class="small">Uses: ${m.uses}</em>`;
                                                        materialsList.appendChild(div);
                                                    });
                                                } else {
                                                    materialsList.innerHTML = '<span class="text-muted">No materials listed.</span>';
                                                }

                                                // Mobs
                                                const racesList = document.getElementById('mobsRacesList');
                                                const enemiesList = document.getElementById('mobsEnemiesList');
                                                const animalsList = document.getElementById('mobsAnimalsList');
                                                const bossesList = document.getElementById('mobsBossesList');

                                                const populateMobCategory = (arr, container) => {
                                                    container.innerHTML = '';
                                                    if (arr?.length) {
                                                        arr.forEach(x => {
                                                            const div = document.createElement('div');
                                                            div.className = 'mb-2';
                                                            div.innerHTML = `<strong>${x.name}</strong><br><span class="text-muted small">${x.lore}</span><br><em class="small">Drops: ${x.drops || '—'}</em>`;
                                                            container.appendChild(div);
                                                        });
                                                    } else {
                                                        container.innerHTML = '<span class="text-muted">None listed.</span>';
                                                    }
                                                };
                                                populateMobCategory(data.mobs?.races, racesList);
                                                populateMobCategory(data.mobs?.enemies, enemiesList);
                                                populateMobCategory(data.mobs?.animals, animalsList);
                                                populateMobCategory(data.mobs?.bosses, bossesList);

                                                // Structures
                                                const structuresList = document.getElementById('structuresList');
                                                structuresList.innerHTML = '';
                                                if (data.structures?.length) {
                                                    data.structures.forEach(s => {
                                                        const div = document.createElement('div');
                                                        div.className = 'mb-2';
                                                        div.innerHTML = `<strong>${s.name}</strong><br><span class="text-muted small">${s.lore}</span><br><em class="small">Loot: ${s.loot || '—'}</em>`;
                                                        structuresList.appendChild(div);
                                                    });
                                                } else {
                                                    structuresList.innerHTML = '<span class="text-muted">No structures listed.</span>';
                                                }

                                                // Characters
                                                const charactersList = document.getElementById('charactersList');
                                                charactersList.innerHTML = '';
                                                if (data.characters?.length) {
                                                    data.characters.forEach(c => {
                                                        const div = document.createElement('div');
                                                        div.className = 'mb-2';
                                                        div.innerHTML = `<strong>${c.name}</strong><br><span class="text-muted small">${c.lore}</span><br><em class="small">Profession: ${c.profession || '—'}</em>`;
                                                        charactersList.appendChild(div);
                                                    });
                                                } else {
                                                    charactersList.innerHTML = '<span class="text-muted">No characters listed.</span>';
                                                }
                                                        <h6 class="text-info"><i class="fas fa-gem me-1"></i>The Mark of Binding</h6>
                                                        <p class="small">The glowing mark that appears on chosen individuals is more than a blessing - it's a key. Each mark is unique and can unlock specific corrals, but using this power comes with great responsibility and unknown consequences.</p>
                                                    </div>
                                                    
                                                    <div class="lore-entry mb-4">
                                                        <h6 class="text-danger"><i class="fas fa-eye me-1"></i>The Watchers</h6>
                                                        <p class="small">Legend speaks of entities that observe the corrals from beyond the veil. Some say they are the original creators, others believe they are the very beings that were sealed away, waiting for their chance to return.</p>
                                                    </div>
                                                    
                                                    <div class="lore-entry">
                                                        <h6 class="text-success"><i class="fas fa-tree me-1"></i>The Living Realms</h6>
                                                        <p class="small">Each corral is more than a prison - they are living ecosystems that have evolved over millennia. The realms respond to the emotions and actions of those who enter, making each journey unique and unpredictable.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Character Relationships -->
                                    <div class="card">
                                        <div class="card-header bg-secondary text-white">
                                            <h5 class="mb-0"><i class="fas fa-project-diagram me-2"></i>Character Relationships & Story Connections</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <h6 class="text-primary">Alliances & Friendships</h6>
                                                    <ul class="list-group list-group-flush">
                                                        <li class="list-group-item d-flex align-items-center">
                                                            <i class="fas fa-handshake text-success me-2"></i>
                                                            <span>Elder Zephyr mentors the Player Character</span>
                                                        </li>
                                                        <li class="list-group-item d-flex align-items-center">
                                                            <i class="fas fa-heart text-danger me-2"></i>
                                                            <span>Lyra forms a spiritual bond with nature-aligned players</span>
                                                        </li>
                                                        <li class="list-group-item d-flex align-items-center">
                                                            <i class="fas fa-shield text-primary me-2"></i>
                                                            <span>The Guardian Alliance protects corral entrances</span>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="col-md-6">
                                                    <h6 class="text-danger">Conflicts & Rivalries</h6>
                                                    <ul class="list-group list-group-flush">
                                                        <li class="list-group-item d-flex align-items-center">
                                                            <i class="fas fa-swords text-danger me-2"></i>
                                                            <span>The Shadow Walker opposes Elder Zephyr's teachings</span>
                                                        </li>
                                                        <li class="list-group-item d-flex align-items-center">
                                                            <i class="fas fa-lightning-bolt text-warning me-2"></i>
                                                            <span>Ancient rivalries between different Corral Keepers</span>
                                                        </li>
                                                        <li class="list-group-item d-flex align-items-center">
                                                            <i class="fas fa-question-circle text-secondary me-2"></i>
                                                            <span>The true intentions of The Watchers remain unknown</span>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- World Tab -->
                        <div class="tab-pane fade" id="world" role="tabpanel">
                            <div class="p-4">
                                <h3 class="text-success mb-4">
                                    <i class="fas fa-globe me-2"></i>World Structure
                                </h3>
                                
                                <!-- World Lore Section -->
                                <div class="card mb-4 border-success">
                                    <div class="card-header bg-gradient text-white" style="background: linear-gradient(135deg, #2d5016 0%, #1a3a0f 100%);">
                                        <h4 class="mb-0">
                                            <i class="fas fa-tree me-2"></i>The Bracken: The World Tree
                                        </h4>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="lore-text">
                                                    <p class="lead text-success mb-3">
                                                        <strong>The Bracken</strong> is an immense feature in the universe, an enigma that defies simple description.
                                                    </p>
                                                    
                                                    <p class="mb-3">
                                                        Long ago, the <strong>Aldrasil</strong> was but a seed—the first thing ever created by the <strong>Asdreth of Nature</strong>. From this primordial seed, the Bracken sprouted, growing to become the foundation of all existence.
                                                    </p>
                                                    
                                                    <p>
                                                        The Bracken resembles a fern with leaves and roots at what is considered the bottom. It holds up the entire world, consisting of <strong>72 Realms</strong>. In itself, the Bracken does not consist of anything at all, yet it is simultaneously made of <em>everything</em>—for it holds all the Realms, and therefore must be made of everything. <strong>Spriggans</strong> have the unique ability to traverse its essence, which is why Spriggans are found in most Realms throughout the world.
                                                    </p>
                                                    
                                                    <p>
                                                        Though considered a tree—<em>The World Tree</em>—the Bracken possesses an unusual shape. While Spriggans dwell upon the "leaf-part" of the Bracken where the Realms flourish, a different type of creature inhabits its roots. These beings are called <strong>Nyvhroths</strong>, and they slowly consume the Bracken's roots, gnawing away at the foundation of all existence.
                                                    </p>
                                                    
                                                    <hr class="my-4">
                                                    
                                                    <div class="row mt-4">
                                                        <div class="col-md-6">
                                                            <div class="realm-info realm-fyrrel p-3 rounded bg-dark" style="min-height: 240px;">
                                                                <h5 class="text-success mb-3">
                                                                    <i class="fas fa-leaf me-2"></i>Fyrrel
                                                                </h5>
                                                                <p class="mb-2"><strong>Location:</strong> The Branches of the Bracken</p>
                                                                <p class="text-muted small mb-0">
                                                                    Fyrrel is a realm located among the branches of the tree, where light and life flourish. This is the homeland of the <strong>Spriggans</strong>, the mystical beings who can walk upon the wood of the Bracken itself, serving as guardians and travelers between the Realms.
                                                                </p>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <div class="realm-info realm-domrar p-3 rounded bg-dark" style="min-height: 240px;">
                                                                <h5 class="mb-3" style="color: #40E0D0;">
                                                                    <i class="fas fa-skull-crossbones me-2"></i>Domrar
                                                                </h5>
                                                                <p class="mb-2"><strong>Location:</strong> The Roots of the Bracken</p>
                                                                <p class="text-muted small">
                                                                    Domrar is a realm located at the roots of the tree, where free souls descend and the Nyvhroths are found. This is the realm of the dead, where souls must prove their worth.
                                                                </p>
                                                                <p class="small mb-0" style="color: #40E0D0;">
                                                                    <i class="fas fa-info-circle me-1"></i>
                                                                    If a soul manages to traverse the entire tree and make it back to the branches where the realms are closer to the leaves, they can begin their afterlife <strong>soulstriding</strong> in all the realms by choice. If not, they remain trapped at the roots.
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                
                                                <!-- Exploration Guidance -->
                                                <div class="mt-4 p-3 border rounded bg-dark">
                                                    <p class="mb-2">
                                                        The Bracken holds many Realms — <strong>72</strong> is the most common depiction. Below you can explore every detail in the <strong>World Book</strong>.
                                                    </p>
                                                    <ul class="mb-3">
                                                        <li>Select a <strong>Corral</strong> to explore</li>
                                                        <li>Select a <strong>Realm</strong> within that Corral</li>
                                                        <li>Select a <strong>Region</strong></li>
                                                        <li>Select an <strong>Area</strong></li>
                                                        <li>Start reading about everything that Area offers</li>
                                                    </ul>
                                                    <p class="mb-0 small text-muted">
                                                        Knowledge includes <strong>Materials</strong>, <strong>Mobs</strong> (Races, Enemies, Animals, Bosses), <strong>Structures</strong>, <strong>Characters</strong>, and the <strong>Lore</strong> of the Realm — what the Realm is the Realm of, reasons to explore it, goals, and rewards.
                                                    </p>
                                                </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="card mb-4">
                                    <div class="card-header bg-success text-white">
                                        <h5 class="mb-0">Explore the World Book</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <select class="form-select form-select-lg" id="corralSelect" onchange="loadCorralRealms()">
                                                    <option value="">Select a Corral...</option>
                                                    <option value="rabbit">Corral 1: The Rabbit (8 Realms and 3 Dwarf-Realms)</option>
                                                    <option value="butterfly">Corral 2: The Butterfly (13 Realms and 4 Dwarf-Realms)</option>
                                                    <option value="bear">Corral 3: The Bear (11 Realms and 2 Dwarf-Realms)</option>
                                                    <option value="dove">Corral 4: The Dove (5 Realms and 1 Dwarf-Realms)</option>
                                                    <option value="crow">Corral 5: The Crow (1 Realm)</option>
                                                    <option value="hidden1">Hidden Corral 1: The Owl (6 Hidden Realms)</option>
                                                    <option value="hidden2">Hidden Corral 2: The Wolf (4 Hidden Realms)</option>
                                                    <option value="hidden3">Hidden Corral 3: The Salmon (9 Hidden Realms)</option>
                                                    <option value="hidden4">Hidden Corral 4: The Fox (3 Hidden Realms)</option>
                                                    <option value="hidden5">Hidden Corral 5: The Snake (2 Hidden Realms)</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <select class="form-select form-select-lg" id="realmSelect" onchange="loadRealmRegions()" disabled>
                                                    <option value="">Select a Corral first...</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="row mt-3">
                                            <div class="col-md-6">
                                                <select class="form-select form-select-lg" id="regionSelect" onchange="loadRegionAreas()" disabled>
                                                    <option value="">Select Corral and Realm first...</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <select class="form-select form-select-lg" id="areaSelect" onchange="loadAreaDetails()" disabled>
                                                    <option value="">Select Region first...</option>
                                                </select>
                                            </div>

                                    </div>
                                </div>

                                <!-- Area Details -->
                                <div id="areaDetails" class="d-none">
                                    <div class="row">
                                        <div class="col-lg-8">
                                            <div class="card">
                                                <div class="card-header bg-info text-white">
                                                    <h5 class="mb-0" id="areaTitle">Area: <span id="areaTitleText"></span></h5>
                                                </div>
                                                <div class="card-body">
                                                    <div class="mb-3">
                                                        <h6 class="text-secondary">Lore</h6>
                                                        <p id="areaLore" class="text-muted mb-0"></p>
                                                    </div>

                                                    <div class="accordion" id="areaAccordion">
                                                        <div class="accordion-item">
                                                            <h2 class="accordion-header" id="materialsHeading">
                                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#materialsCollapse">
                                                                    Materials
                                                                </button>
                                                            </h2>
                                                            <div id="materialsCollapse" class="accordion-collapse collapse" data-bs-parent="#areaAccordion">
                                                                <div class="accordion-body" id="materialsList"></div>
                                                            </div>
                                                        </div>
                                                        <div class="accordion-item">
                                                            <h2 class="accordion-header" id="mobsHeading">
                                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#mobsCollapse">
                                                                    Mobs (Races, Enemies, Animals, Bosses)
                                                                </button>
                                                            </h2>
                                                            <div id="mobsCollapse" class="accordion-collapse collapse" data-bs-parent="#areaAccordion">
                                                                <div class="accordion-body">
                                                                    <div class="accordion" id="mobsNestedAccordion">
                                                                        <div class="accordion-item">
                                                                            <h2 class="accordion-header" id="mobsRacesHeading">
                                                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#mobsRacesCollapse">Races</button>
                                                                            </h2>
                                                                            <div id="mobsRacesCollapse" class="accordion-collapse collapse" data-bs-parent="#mobsNestedAccordion">
                                                                                <div class="accordion-body" id="mobsRacesList"></div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="accordion-item">
                                                                            <h2 class="accordion-header" id="mobsEnemiesHeading">
                                                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#mobsEnemiesCollapse">Enemies</button>
                                                                            </h2>
                                                                            <div id="mobsEnemiesCollapse" class="accordion-collapse collapse" data-bs-parent="#mobsNestedAccordion">
                                                                                <div class="accordion-body" id="mobsEnemiesList"></div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="accordion-item">
                                                                            <h2 class="accordion-header" id="mobsAnimalsHeading">
                                                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#mobsAnimalsCollapse">Animals</button>
                                                                            </h2>
                                                                            <div id="mobsAnimalsCollapse" class="accordion-collapse collapse" data-bs-parent="#mobsNestedAccordion">
                                                                                <div class="accordion-body" id="mobsAnimalsList"></div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="accordion-item">
                                                                            <h2 class="accordion-header" id="mobsBossesHeading">
                                                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#mobsBossesCollapse">Bosses</button>
                                                                            </h2>
                                                                            <div id="mobsBossesCollapse" class="accordion-collapse collapse" data-bs-parent="#mobsNestedAccordion">
                                                                                <div class="accordion-body" id="mobsBossesList"></div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="accordion-item">
                                                            <h2 class="accordion-header" id="structuresHeading">
                                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#structuresCollapse">
                                                                    Structures
                                                                </button>
                                                            </h2>
                                                            <div id="structuresCollapse" class="accordion-collapse collapse" data-bs-parent="#areaAccordion">
                                                                <div class="accordion-body" id="structuresList"></div>
                                                            </div>
                                                        </div>
                                                        <div class="accordion-item">
                                                            <h2 class="accordion-header" id="charactersHeading">
                                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#charactersCollapse">
                                                                    Characters
                                                                </button>
                                                            </h2>
                                                            <div id="charactersCollapse" class="accordion-collapse collapse" data-bs-parent="#areaAccordion">
                                                                <div class="accordion-body" id="charactersList"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-4">
                                            <div class="card">
                                                <div class="card-header bg-dark text-white">
                                                    <h6 class="mb-0">Area Map</h6>
                                                </div>
                                                <div class="card-body">
                                                    <div class="text-center p-4 border rounded">
                                                        <i class="fas fa-map fa-3x text-muted mb-2"></i>
                                                        <p class="text-muted">Area map visualization</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                 </div
                            </div>
                        </div>

                        <!-- Mechanics Tab -->
                        <div class="tab-pane fade" id="mechanics" role="tabpanel">
                            <div class="p-4">
                                <h3 class="text-warning mb-4">
                                    <i class="fas fa-cog me-2"></i>Game Mechanics
                                </h3>
                                <p class="text-muted">Mechanics content coming soon...</p>
                            </div>
                        </div>

                        <!-- Wiki Tab -->
                        <div class="tab-pane fade" id="wiki" role="tabpanel">
                            <div class="p-4">
                                <h3 class="text-info mb-4">
                                    <i class="fas fa-book-open me-2"></i>Game Guide & Wiki
                                </h3>
                                <p class="text-muted">Wiki content coming soon...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
const worldData = {
    rabbit: {
        name: "Corral 1: The Rabbit",
        realms: {
            barikir: "Barikir",
            nibur: "Nibur",
            dulrog: "Dulrog",
            macuetz: "Macuetz",
            snuhk: "Snuhk",
            sephe: "Sephe",
            steplar: "Steplar",
            igneous: "Igneous"
        },
        dwarfRealms: {
            noom: "Noom",
            hogway: "Hogway",
            tawing: "Tawing"
        },
        regions: {
            barikir: ["center", "north", "south", "west", "east", "underground", "sky", "far_north", "far_south", "far_west", "far_east", "border"],
            nibur: ["center", "north", "south", "west", "east", "underground", "far_north", "far_south", "far_west", "far_east", "border"],
            dulrog: ["center", "underground", "border"],
            macuetz: ["center", "north", "south", "west", "east", "underground", "far_north", "far_south", "far_west", "far_east", "border"],
            snuhk: ["center", "north", "south", "west", "east", "underground", "far_north", "far_west", "border"],
            sephe: ["center", "north", "south", "west", "east", "underground", "far_north", "far_south", "far_west", "far_east", "border"],
            steplar: ["center", "north", "south", "west", "east", "underground", "far_north", "far_west", "far_east", "border"],
            igneous: ["center", "north", "south", "west", "east", "underground", "sky", "far_north", "far_south", "far_west", "far_east", "border"],
            noom: ["center", "underground", "border"],
            hogway: ["center", "underground", "border"],
            tawing: ["center", "north", "south", "west", "east", "underground", "sky", "border"]
        }
    },
    butterfly: {
        name: "Corral 2: The Butterfly",
        realms: {
            brusiv: "Brusiv",
            kroom: "Kroom",
            dusfer: "Dusfer",
            iclas: "Iclas",
            abzithal: "Abzithal",
            rabuhist: "Rabuhist",
            jhekal: "Jhekal",
            enoki: "Enoki",
            tokist: "Tokist",
            vermu: "Vermu",
            stolid: "Stolid",
            aksber: "Aksber",
            raxarall: "Raxa Rall"
        },
        dwarfRealms: {
            niim: "Niim",
            hazen: "Hazen",
            yplov: "Yplov",
            grevca: "Grevca"
        },
        regions: {
            brusiv: ["center", "north", "south", "west", "east", "underground", "border"],
            kroom: ["center", "north", "west", "border"],
            dusfer: ["center", "west", "south", "border"],
            iclas: ["center", "north", "south", "west", "east", "underground", "border"],
            abzithal: ["center", "border"],
            rabuhist: ["center", "north", "south", "west", "east", "border"],
            jhekal: ["center", "north", "south", "west", "east", "underground", "sky", "far_north", "far_south", "far_east", "border"],
            enoki: ["center", "underground", "border"],
            tokist: ["center", "border"],
            vermu: ["center", "north", "underground", "border"],
            stolid: ["center", "north", "south", "underground", "border"],
            aksber: ["center", "north", "south", "west", "east", "underground", "border"],
            raxarall: ["center", "north", "south", "west", "east", "border"],
            niim: ["center", "border"],
            hazen: ["center", "east", "border"],
            yplov: ["center", "border"],
            grevca: ["center", "west", "east", "underground", "sky", "border"]
        }
    },
    bear: {
        name: "Corral 3: The Bear",
        realms: {
            calwren: "Calwren",
            aldrasilt: "Aldrasilt",
            kyrun: "Kyrun",
            rikis: "Rikis",
            lavier: "Lavier",
            erode: "Erode",
            siltred: "Siltred",
            brawn: "Brawn",
            kempel: "Kempel",
            limpid: "Limpid",
            qhorthest: "Qhorthest"
        },
        dwarfRealms: {
            goral: "Goral",
            dukun: "Dukun"
        },
        regions: {
            calwren: ["center", "north", "south", "west", "east", "underground", "far_north", "far_south", "far_west", "far_east", "border"],
            aldrasilt: ["center", "north", "south", "west", "east", "underground", "far_north", "far_south", "far_west", "far_east", "border"],
            kyrun: ["center", "border"],
            rikis: ["center", "north", "south", "west", "east", "sky", "far_south", "far_west", "border"],
            lavier: ["center", "north", "south", "west", "east", "sky", "far_north", "far_south", "far_west", "far_east", "border"],
            erode: ["center", "north", "south", "west", "east", "underground", "far_north", "far_east", "border"],
            siltred: ["center", "border"],
            brawn: ["center", "underground", "border"],
            kempel: ["center", "north", "south", "west", "east", "far_south", "far_west", "far_east", "border"],
            limpid: ["center", "south", "east", "border"],
            qhorthest: ["center", "underground", "border"],
            goral: ["center", "north", "south", "west", "east", "underground", "border"],
            dukun: ["center", "border"]
        }
    },
    dove: {
        name: "Corral 4: The Dove",
        realms: {
            vogatir: "Vogatir",
            egraen: "Egraen",
            envin: "Envin",
            ztonphior: "Ztonphior",
            vacant: "Vacant"
        },
        dwarfRealms: {
            peril: "Peril"
        },
        regions: {
            vogatir: ["center", "sky", "border"],
            egraen: ["center", "north", "south", "west", "east", "underground", "border"],
            envin: ["center", "north", "south", "west", "east", "underground", "border"],
            ztonphior: ["center", "border"],
            vacant: ["center", "sky", "border"],
            peril: ["center", "border"]
        }
    },
    crow: {
        name: "Corral 5: The Crow",
        realms: {
            axrak: "Axrak"
        },
        regions: {
            axrak: ["center", "border"]
        }
    },
    hidden1: {
        name: "Hidden Corral 1: The Owl",
        realms: {
            kuhre: "Kuhre",
            eldtic: "Eldtic",
            vapid: "Vapid",
            algetarne: "Algetarné",
            tawals: "Tawals",
            highriff: "Highriff"
        },
        regions: {
            kuhre: ["center", "underground", "border"],
            eldtic: ["center", "border"],
            vapid: ["center", "border"],
            algetarne: ["center", "border"],
            tawals: ["center", "border"],
            highriff: ["center", "north", "south", "west", "east", "underground", "far_north", "far_south", "far_west", "far_east", "border"]
        }
    },
    hidden2: {
        name: "Hidden Corral 2: The Wolf",
        realms: {
            blukk: "Blukk",
            muppyst: "Muppyst",
            placid: "Placid",
            ferrun: "Ferrun"
        },
        regions: {
            blukk: ["center", "border"],
            muppyst: ["center", "border"],
            placid: ["center", "border"],
            ferrun: ["center", "border"]
        }
    },
    hidden3: {
        name: "Hidden Corral 3: The Salmon",
        realms: {
            nimbel: "Nimbel",
            ridoxet: "Ridoxet",
            apnirt: "Apnirt",
            yreg: "Yreg",
            rhoulder: "Rhoulder",
            uriendel: "Uriendel Dreirn",
            tsiqaki: "Tsiqaki",
            auverith: "Auverith",
            enduriken: "Enduriken"
        },
        regions: {
            nimbel: ["center", "border"],
            ridoxet: ["north", "south", "east", "west", "underground", "border"],
            apnirt: ["center", "border"],
            yreg: ["center", "west", "south", "north", "underground", "border"],
            rhoulder: ["center", "border"],
            uriendel: ["center", "border"],
            tsiqaki: ["center", "border"],
            auverith: ["center", "underground", "border"],
            enduriken: ["center", "north", "south", "border"]
        }
    },
    hidden4: {
        name: "Hidden Corral 4: The Fox",
        realms: {
            syluvar: "Syluvar",
            odrengea: "Odrengea",
            tenuous: "Tenuous"
        },
        regions: {
            syluvar: ["center", "border"],
            odrengea: ["center", "border"],
            tenuous: ["center", "border"]
        }
    },
    hidden5: {
        name: "Hidden Corral 5: The Snake",
        realms: {
            johre: "Johre",
            wryndor: "Wryndor"
        },
        regions: {
            johre: ["center", "north", "east", "west", "border"],
            wryndor: ["center", "border"]
        }
    }
};

// Area data for each region (Region → Areas)
const areaData = {
    // New scoped keys: <realm>:<region>
    "barikir:center": [
        "Elwood",
        "Haerlake",
        "Hilk",
        "Gihl",
        "Roofed Forest",
        "Niivla Woods",
        "Rofgard",
        "Gavel",
        "Wheat Fields",
        "Grenaa",
        "Agerbo",
        "Aphlas",
        "Djemun",
        "Garzen",
        "Mursgrun",
        "Harakk",
        "Anker",
        "Esten",
        "Heurldron",
        "Merl",
        "Skell"
    ]
};

// Content data for each area (Materials, Mobs, Structures, Characters, Lore)
const areaContentData = {
    // Example content schema for Barikir Center areas
    "Elwood": {
        lore: "A quiet woodland settlement where travelers rest and exchange stories.",
        materials: [
            { name: "Oak Wood", lore: "Sturdy timber from ancient trees.", uses: "Building, weapon hafts" },
            { name: "Herb Sprig", lore: "Common medicinal plant.", uses: "Potions, salves" }
        ],
        mobs: {
            races: [ { name: "Spriggan Wanderer", lore: "A friendly guardian of the woods.", drops: "Spriggan Leaf" } ],
            enemies: [ { name: "Bog Thief", lore: "Petty bandit hiding near marshes.", drops: "Tattered Cloth" } ],
            animals: [ { name: "Stag", lore: "Majestic deer roaming the groves.", drops: "Antler Shard" } ],
            bosses: [ { name: "Grove Warden", lore: "Protector spirit of Elwood.", drops: "Warden Bark" } ]
        },
        structures: [
            { name: "Waystone", lore: "Guides travelers through the forest.", loot: "Waystone Dust" },
            { name: "Hunter Cabin", lore: "Shelter used by local hunters.", loot: "Camping Gear" }
        ],
        characters: [
            { name: "Merra the Herbalist", lore: "Knows every plant in Elwood.", profession: "Alchemy vendor" },
            { name: "Joran the Tracker", lore: "Finds lost paths for a fee.", profession: "Guide" }
        ]
    }
};

function loadCorralRealms() {
    const corralSelect = document.getElementById('corralSelect');
    const realmSelect = document.getElementById('realmSelect');
    const regionSelect = document.getElementById('regionSelect');
    const areaSelect = document.getElementById('areaSelect');
    
    const selectedCorral = corralSelect.value;
    
    realmSelect.innerHTML = '<option value="">Choose a Realm...</option>';
    regionSelect.innerHTML = '<option value="">Select Corral and Realm first...</option>';
    areaSelect.innerHTML = '<option value="">Select Region first...</option>';
    regionSelect.disabled = true;
    areaSelect.disabled = true;
    document.getElementById('areaDetails').classList.add('d-none');
    
    if (selectedCorral && worldData[selectedCorral]) {
        realmSelect.disabled = false;
        const realms = worldData[selectedCorral].realms;
        const dwarfRealms = worldData[selectedCorral].dwarfRealms;
        
        // Add regular realms
        for (const [key, name] of Object.entries(realms)) {
            const option = document.createElement('option');
            option.value = key;
            option.textContent = name;
            realmSelect.appendChild(option);
        }
        
        // Add dwarf-realms if they exist
        if (dwarfRealms) {
            // Add separator
            const separator = document.createElement('option');
            separator.disabled = true;
            separator.textContent = '--- Dwarf-Realms ---';
            realmSelect.appendChild(separator);
            
            for (const [key, name] of Object.entries(dwarfRealms)) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = name;
                realmSelect.appendChild(option);
            }
        }
    } else {
        realmSelect.disabled = true;
    }
}

function loadRealmRegions() {
    const corralSelect = document.getElementById('corralSelect');
    const realmSelect = document.getElementById('realmSelect');
    const regionSelect = document.getElementById('regionSelect');
    const areaSelect = document.getElementById('areaSelect');
    
    const selectedCorral = corralSelect.value;
    const selectedRealm = realmSelect.value;
    
    regionSelect.innerHTML = '<option value="">Choose a Region...</option>';
    areaSelect.innerHTML = '<option value="">Select Region first...</option>';
    areaSelect.disabled = true;
    document.getElementById('areaDetails').classList.add('d-none');
    
    if (selectedCorral && selectedRealm) {
        regionSelect.disabled = false;
        
        // Get available regions for this realm
        const availableRegions = worldData[selectedCorral]?.regions[selectedRealm] || [];
        
        // All possible regions in display order
        const allRegions = [
            { key: 'center', label: 'Center' },
            { key: 'north', label: 'North' },
            { key: 'south', label: 'South' },
            { key: 'west', label: 'West' },
            { key: 'east', label: 'East' },
            { key: 'underground', label: 'Underground' },
            { key: 'sky', label: 'Sky' },
            { key: 'far_north', label: 'Far North' },
            { key: 'far_south', label: 'Far South' },
            { key: 'far_west', label: 'Far West' },
            { key: 'far_east', label: 'Far East' },
            { key: 'border', label: 'Realm Border' }
        ];
        
        // Add all regions, but disable those not available
        allRegions.forEach(region => {
            const option = document.createElement('option');
            option.value = region.key;
            option.textContent = region.label;
            
            if (!availableRegions.includes(region.key)) {
                option.disabled = true;
                option.style.color = '#6c757d';
                option.textContent += ' (Not existent)';
            }
            
            regionSelect.appendChild(option);
        });
    } else {
        regionSelect.disabled = true;
    }
}

function loadRegionAreas() {
    const regionSelect = document.getElementById('regionSelect');
    const realmSelect = document.getElementById('realmSelect');
    const areaSelect = document.getElementById('areaSelect');
    const selectedRegion = regionSelect.value;
    const selectedRealm = realmSelect.value;

    areaSelect.innerHTML = '<option value="">Choose an Area...</option>';
    document.getElementById('areaDetails').classList.add('d-none');

    // Use composite key realm:region to support identical region names across realms
    const key = selectedRealm && selectedRegion ? `${selectedRealm}:${selectedRegion}` : '';

    if (key && areaData[key]) {
        areaSelect.disabled = false;
        const areas = areaData[key];

        areas.forEach(area => {
            const option = document.createElement('option');
            option.value = area;
            option.textContent = area;
            areaSelect.appendChild(option);
        });
    } else {
        areaSelect.disabled = true;
    }
}

function loadAreaDetails() {
    const areaSelect = document.getElementById('areaSelect');
    const selectedArea = areaSelect.value;
    
    if (selectedArea) {
        document.getElementById('areaTitle').textContent = selectedArea;
        document.getElementById('areaDetails').classList.remove('d-none');
        
        const data = areaContentData[selectedArea] || {
            materials: ["Common Ore", "Basic Herbs", "Wood", "Stone"],
            enemies: ["Goblin", "Wolf", "Spider", "Orc"],
            bosses: ["Area Guardian"],
            gear: ["Basic Sword", "Leather Armor", "Simple Shield"],
            skills: ["Basic Combat", "Survival", "Crafting"]
        };
        
        populateList('materialsList', data.materials, 'primary');
        populateList('enemiesList', data.enemies, 'danger');
        populateList('bossesList', data.bosses, 'warning');
        populateList('gearList', data.gear, 'success');
        populateList('skillsList', data.skills, 'info');
    }
}

function populateList(elementId, items, badgeColor) {
    const element = document.getElementById(elementId);
    element.innerHTML = '';
    
    items.forEach(item => {
        const badge = document.createElement('span');
        badge.className = `badge bg-${badgeColor} me-2 mb-1`;
        badge.textContent = item;
        element.appendChild(badge);
    });
}
</script>

<style>
.nav-tabs .nav-link {
    color: #6c757d;
    font-weight: 500;
}

.nav-tabs .nav-link.active {
    background-color: #0d6efd;
    border-color: #0d6efd;
    color: white;
}

.nav-tabs .nav-link:hover {
    border-color: #e9ecef #e9ecef #dee2e6;
    color: #0d6efd;
}

.card {
    border: none;
}

.accordion-button:not(.collapsed) {
    background-color: #e3f2fd;
    color: #1976d2;
}

.badge {
    font-size: 0.75em;
}

/* Animated realm borders */
.realm-domrar {
    border: 3px solid #5a4a3a;
    position: relative;
    overflow: visible;
}

.realm-domrar::before,
.realm-domrar::after {
    content: '';
    position: absolute;
    width: 50px;
    height: 3px;
    background: linear-gradient(90deg, transparent, #40E0D0, #40E0D0, transparent);
    box-shadow: 0 0 10px #40E0D0;
    animation: travelBorderDomrar 6s linear infinite;
    z-index: 10;
}

.realm-domrar::after {
    animation-delay: 3s;
}

.realm-fyrrel {
    border: 3px solid #28a745;
    position: relative;
    overflow: visible;
}

.realm-fyrrel::before,
.realm-fyrrel::after {
    content: '';
    position: absolute;
    width: 50px;
    height: 3px;
    background: linear-gradient(90deg, transparent, #40E0D0, #40E0D0, transparent);
    box-shadow: 0 0 10px #40E0D0;
    animation: travelBorderFyrrel 6s linear infinite;
    z-index: 10;
}

.realm-fyrrel::after {
    animation-delay: 3s;
}

@keyframes travelBorderDomrar {
    0% {
        top: -3px;
        left: 0;
        width: 50px;
        height: 3px;
    }
    23% {
        top: -3px;
        left: calc(100% - 50px);
        width: 50px;
        height: 3px;
    }
    25% {
        top: 0;
        left: 100%;
        width: 3px;
        height: 50px;
    }
    48% {
        top: calc(100% - 50px);
        left: 100%;
        width: 3px;
        height: 50px;
    }
    50% {
        top: 100%;
        left: calc(100% - 50px);
        width: 50px;
        height: 3px;
    }
    73% {
        top: 100%;
        left: 0;
        width: 50px;
        height: 3px;
    }
    75% {
        top: calc(100% - 50px);
        left: -3px;
        width: 3px;
        height: 50px;
    }
    98% {
        top: 0;
        left: -3px;
        width: 3px;
        height: 50px;
    }
    100% {
        top: -3px;
        left: 0;
        width: 50px;
        height: 3px;
    }
}

@keyframes travelBorderFyrrel {
    0% {
        top: -3px;
        left: 0;
        width: 50px;
        height: 3px;
    }
    23% {
        top: -3px;
        left: calc(100% - 50px);
        width: 50px;
        height: 3px;
    }
    25% {
        top: 0;
        left: 100%;
        width: 3px;
        height: 50px;
    }
    48% {
        top: calc(100% - 50px);
        left: 100%;
        width: 3px;
        height: 50px;
    }
    50% {
        top: 100%;
        left: calc(100% - 50px);
        width: 50px;
        height: 3px;
    }
    73% {
        top: 100%;
        left: 0;
        width: 50px;
        height: 3px;
    }
    75% {
        top: calc(100% - 50px);
        left: -3px;
        width: 3px;
        height: 50px;
    }
    98% {
        top: 0;
        left: -3px;
        width: 3px;
        height: 50px;
    }
    100% {
        top: -3px;
        left: 0;
        width: 50px;
        height: 3px;
    }
}
</style>
{% endblock %}